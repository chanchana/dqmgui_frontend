{"version":3,"file":"static/webpack/static/development/pages/index.js.9e713fc871a5d830405f.hot-update.js","sources":["webpack:///./hooks/useRequest.tsx"],"sourcesContent":["import { useState, useEffect, useRef } from 'react';\nimport axios, {\n  AxiosRequestConfig,\n  AxiosResponse,\n  CancelTokenSource,\n} from 'axios';\n\nimport { root_url } from '../config/config';\n\ninterface ReturnRequest {\n  data: any;\n  errors: any;\n  isLoading: boolean;\n  cancelSource: any;\n}\n\n//for traching, which req. should be canceled\n\nexport const useRequest = (\n  url: string,\n  options: AxiosRequestConfig = {},\n  watchers: any[] = [],\n  should_we_fetch: boolean = true\n): ReturnRequest => {\n  const [data, setData] = useState(null);\n  const [isLoading, setIsLoading] = useState(false);\n  const cancelSource = useRef<CancelTokenSource | null>(null);\n  const [errors, setEerrors] = useState<string[]>([]);\n\n  useEffect(() => {\n    if (cancelSource) {\n      cancelSource.current?.cancel();\n    }\n  }, []);\n\n  useEffect(() => {\n    const CancelToken = axios.CancelToken;\n    cancelSource.current = CancelToken.source();\n\n    const fetchData = async () => {\n      setIsLoading(true);\n      try {\n        setTimeout(cancelSource.current?.cancel, 180000);\n        const response: AxiosResponse = await axios.request({\n          url: `${root_url}${url}`,\n          method: options.method || 'get',\n          cancelToken: cancelSource.current?.token,\n          ...options,\n        });\n        const { data } = response;\n        setData(data);\n        setIsLoading(false);\n      } catch (error) {\n        setIsLoading(false);\n        setEerrors([error.toString()]);\n        if (axios.isCancel(error)) {\n          setIsLoading(false);\n          setEerrors(['Request Timeout']);\n        }\n        cancelSource.current?.cancel();\n      }\n    };\n    if (should_we_fetch) {\n      fetchData();\n    }\n  }, watchers);\n  return { data, isLoading, errors, cancelSource };\n};\n"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;AAAA;AACA;AAMA;AASA;AAEA;AAKA;AAAA;AAAA;AACA;AADA;AAAA;AAAA;AACA;AADA;AAAA;AAAA;AACA;AAEA;AACA;AAJA;AAAA;AAAA;AACA;AAKA;AACA;AAAA;AACA;AAAA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AAAA;AACA;AADA;AAAA;AAAA;AAAA;AACA;AADA;AAGA;AAHA;AAAA;AAKA;AACA;AACA;AAHA;AACA;AALA;AAIA;AAMA;AACA;AACA;AAZA;AAAA;AACA;AADA;AAAA;AAAA;AAcA;AACA;AACA;AAAA;AACA;AACA;AACA;AACA;AAAA;AACA;AArBA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AAsBA;AACA;AACA;AACA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;;;;A","sourceRoot":""}