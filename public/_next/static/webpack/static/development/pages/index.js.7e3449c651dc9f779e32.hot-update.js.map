{"version":3,"file":"static/webpack/static/development/pages/index.js.7e3449c651dc9f779e32.hot-update.js","sources":["webpack:///./components/utils.ts","webpack:///./pages/index.tsx"],"sourcesContent":["export const seperateRunAndLumiInSearch = (runAndLumi: string) => {\r\n    const runAndLumiArray = runAndLumi.split(':')\r\n    const parsedRun = runAndLumiArray[0]\r\n    const parsedLumi = runAndLumiArray[1] ? parseInt(runAndLumiArray[1]) : NaN\r\n\r\n    return { parsedRun, parsedLumi }\r\n}","import React from 'react';\nimport { NextPage } from 'next';\nimport Head from 'next/head';\nimport Router, { useRouter } from 'next/router';\nimport { Tooltip } from 'antd';\n\nimport Nav from '../components/Nav';\nimport SearchResults from '../containers/search/SearchResults';\nimport DiplayFolders from '../containers/display/DisplayFolderAndPlot';\nimport { useSearch } from '../hooks/useSearch';\nimport {\n  StyledHeader,\n  StyledLayout,\n  StyledDiv,\n  StyledLogoWrapper,\n  StyledLogo,\n  StyledLogoDiv,\n} from '../styles/styledComponents';\nimport {\n  NotFoundDiv,\n  NotFoundDivWrapper,\n  ChartIcon,\n} from '../containers/search/styledComponents';\nimport { FolderPathQuery, QueryProps } from '../containers/display/interfaces';\nimport { workspaces } from '../workspaces/offline';\nimport { ComposedSearch } from '../components/navigation/composedSearch';\nimport { seperateRunAndLumiInSearch } from '../components/utils'\nimport { changeRouter, getChangedQueryParams } from '../containers/display/utils';\n\nconst navigationHandler = (\n  search_by_run_number: string,\n  search_by_dataset_name: string\n) => {\n  Router.replace({\n    pathname: '/',\n    query: {\n      search_run_number: search_by_run_number,\n      search_dataset_name: search_by_dataset_name,\n    },\n  });\n};\n\nconst backToMainPage = () => {\n  Router.replace({\n    pathname: '/',\n    query: {\n      search_run_number: '',\n      search_dataset_name: '',\n    },\n  });\n};\n\nconst Index: NextPage<FolderPathQuery> = () => {\n  // We grab the query from the URL:\n  const router = useRouter();\n  const query: QueryProps = router.query;\n  \n  const serchResultsHandler = (run: string, dataset: string) => {\n    const { parsedRun, parsedLumi } = seperateRunAndLumiInSearch(run)\n    changeRouter(getChangedQueryParams({\n      lumi: parsedLumi,\n      run_number: parsedRun,\n      dataset_name: dataset,\n      workspaces: workspaces[0].workspaces[2].label\n    }, query))\n  };\n\n  const { results, results_grouped, searching, isLoading, errors } = useSearch(\n    query.search_run_number,\n    query.search_dataset_name\n  );\n\n  const isDatasetAndRunNumberSelected =\n    !!query.run_number && !!query.dataset_name;\n\n  return (\n    <StyledDiv>\n      <Head>\n        <script\n          crossOrigin=\"anonymous\"\n          type=\"text/javascript\"\n          src=\"/jsroot-5.8.0/scripts/JSRootCore.js?2d&hist&more2d\"\n        ></script>\n      </Head>\n      <StyledLayout>\n        <StyledHeader>\n          <Tooltip title=\"Back to main page\" placement=\"bottomLeft\">\n            <StyledLogoDiv>\n              <StyledLogoWrapper onClick={() => backToMainPage()}>\n                <StyledLogo src=\"/images/CMSlogo_white_red_nolabel_1024_May2014.png\" />\n              </StyledLogoWrapper>\n            </StyledLogoDiv>\n          </Tooltip>\n          {\n            //if all full set is selected: dataset name and run number, then regular search field is not visible.\n            //Instead, run and dataset browser is is displayed.\n            //Regular search fields are displayed just in the main page.\n            isDatasetAndRunNumberSelected ? (\n              <ComposedSearch />\n            ) : (\n                <>\n                  <Nav\n                    initial_search_run_number={query.search_run_number}\n                    initial_search_dataset_name={query.search_dataset_name}\n                    handler={navigationHandler}\n                    type=\"top\"\n                  />\n                </>\n              )\n          }\n        </StyledHeader>\n        {/* {validation_errors.length > 0 ? (\n          <QueryValidationErrors validation_errors={validation_errors} />\n        ) : */}\n        {query.run_number && query.dataset_name ? (\n          // If a user already has a run_number and dataset_name, he is not searching nor is he in the homepage, he is\n          <DiplayFolders\n            run_number={query.run_number}\n            dataset_name={query.dataset_name}\n            folder_path={query.folder_path || ''}\n          />\n        ) : searching ? (\n          <SearchResults\n            isLoading={isLoading}\n            results={results}\n            results_grouped={results_grouped}\n            handler={serchResultsHandler}\n            errors={errors}\n          />\n        ) : (\n              <NotFoundDivWrapper>\n                <NotFoundDiv noBorder>\n                  <ChartIcon />\n              Welcome to DQM GUI\n            </NotFoundDiv>\n              </NotFoundDivWrapper>\n            )}\n      </StyledLayout>\n    </StyledDiv>\n  );\n};\n\nexport default Index;\n"],"mappings":";;;;;;;;;;AAAA;AAAA;AAAA;AACA;AACA;AACA;AAEA;AAAA;AAAA;AAAA;AACA;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;ACNA;AAEA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AAQA;AAMA;AACA;AACA;AACA;AACA;AACA;AAIA;AACA;AACA;AACA;AACA;AAFA;AAFA;AAOA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAFA;AAFA;AAOA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAAA;AAAA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AAJA;AAMA;AACA;AAdA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AAmBA;AAGA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAEA;AACA;AACA;AAHA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAMA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAMA;AACA;AACA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAIA;AACA;AACA;AACA;AAJA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAeA;AACA;AACA;AACA;AAHA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAOA;AACA;AACA;AACA;AACA;AALA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAQA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAQA;AACA;AACA;;;;A","sourceRoot":""}