{"version":3,"file":"static/webpack/static/development/pages/index.js.29b6dc1f325d76e722d9.hot-update.js","sources":["webpack:///./components/browsing/index.tsx"],"sourcesContent":["import React, { useState, useEffect } from 'react';\r\nimport Form from 'antd/lib/form/Form';\r\n\r\nimport { WrapperDiv } from '../../containers/display/styledComponents';\r\nimport { DatasetsBrowser } from './datasetsBrowsing/datasetsBrowser';\r\nimport { DatasetsBuilder } from './datasetsBrowsing/datasetNameBuilder';\r\nimport { RunBrowser } from './runsBrowser';\r\nimport { LumesectionBrowser } from './lumesectionBroweser';\r\nimport { dataSetSelections } from '../constants';\r\nimport { StyledFormItem } from '../styledComponents';\r\nimport { DropdownMenu } from '../menu';\r\nimport { useRouter } from 'next/router';\r\nimport { QueryProps } from '../../containers/display/interfaces';\r\nimport { useChangeRouter } from '../../hooks/useChangeRouter';\r\nimport { store } from '../../contexts/leftSideContext';\r\nimport { changeRouter, getChangedQueryParams } from '../../containers/display/utils';\r\n\r\n\r\nexport const Browser = () => {\r\n  const [datasetOption, setDatasetOption] = useState(\r\n    dataSetSelections[0].value\r\n  );\r\n  const router = useRouter();\r\n  const query: QueryProps = router.query;\r\n\r\n  const run_number = query.run_number ? query.run_number : '';\r\n  const dataset_name = query.dataset_name ? query.dataset_name : '';\r\n  const lumi = query.lumi ? parseInt(query.lumi) : NaN;\r\n\r\n  const { setLumisection } = React.useContext(store)\r\n  const [currentRunNumber, setCurrentRunNumber] = useState(run_number);\r\n  const [currentDataset, setCurrentDataset] = useState<string>(dataset_name);\r\n\r\n  const lumisectionsChangeHandler = (lumi: number) => {\r\n    //in main navigation when lumisection is changed, new value have to be set to url\r\n    changeRouter(getChangedQueryParams({ lumi: lumi }, query))\r\n    //setLumisection from store(using useContext) set lumisection value globally.\r\n    //This set value is reachable for lumisection browser in free search dialog (you can see it, when search button next to browsers is clicked).\r\n\r\n    //Both lumisection browser have different handers, they have to act differently according to their place:\r\n    //IN THE MAIN NAV: lumisection browser value in the main navigation is changed, this HAVE to be set to url;\r\n    //FREE SEARCH DIALOG: lumisection browser value in free search dialog is changed it HASN'T to be set to url immediately, just when button 'ok' \r\n    //in dialog is clicked THEN value is set to url. So, useContext let us to change lumi value globally without changing url, when wee no need that.\r\n     //And in this handler lumi value set to useContext store is used as initial lumi value in free search dialog. \r\n    setLumisection(lumi)\r\n  }\r\n\r\n  useChangeRouter({\r\n    run_number: currentRunNumber, dataset_name: currentDataset\r\n  }, [currentRunNumber, currentDataset], true)\r\n\r\n  return (\r\n    <Form>\r\n      <WrapperDiv>\r\n        <WrapperDiv>\r\n          <RunBrowser\r\n            query={query}\r\n            currentRunNumber={currentRunNumber}\r\n            setCurrentRunNumber={setCurrentRunNumber}\r\n            currentDataset={currentDataset}\r\n          />\r\n        </WrapperDiv>\r\n        <WrapperDiv>\r\n          <LumesectionBrowser\r\n            currentLumisection={lumi}\r\n            currentRunNumber={currentRunNumber}\r\n            currentDataset={currentDataset}\r\n            handler={lumisectionsChangeHandler}\r\n            color='white'\r\n          />\r\n        </WrapperDiv>\r\n        <StyledFormItem\r\n          label={\r\n            <DropdownMenu\r\n              options={dataSetSelections}\r\n              action={setDatasetOption}\r\n              defaultValue={dataSetSelections[0]}\r\n            />\r\n          }\r\n        >\r\n          {datasetOption === dataSetSelections[0].value ? (\r\n            <WrapperDiv>\r\n              <DatasetsBrowser\r\n                currentRunNumber={currentRunNumber}\r\n                currentDataset={currentDataset}\r\n                setCurrentDataset={setCurrentDataset}\r\n                query={query}\r\n              />\r\n            </WrapperDiv>\r\n          ) : (\r\n              <WrapperDiv>\r\n                <DatasetsBuilder\r\n                  currentRunNumber={currentRunNumber}\r\n                  currentDataset={currentDataset}\r\n                  query={query}\r\n                />\r\n              </WrapperDiv>\r\n            )}\r\n        </StyledFormItem>\r\n      </WrapperDiv>\r\n    </Form>\r\n  );\r\n};\r\n"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAAA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AAGA;AAAA;AAAA;AAAA;AACA;AAGA;AACA;AAEA;AACA;AACA;AACA;AAVA;AAAA;AACA;AADA;AAAA;AAAA;AACA;AADA;AAAA;AAAA;AACA;AAcA;AACA;AACA;AAAA;AAAA;AAEA;AAEA;AACA;AACA;AACA;AACA;AACA;AAAA;AACA;AACA;AACA;AACA;AAAA;AADA;AAIA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAEA;AACA;AACA;AACA;AAJA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAOA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAEA;AACA;AACA;AACA;AACA;AALA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AASA;AAEA;AACA;AACA;AAHA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAFA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAUA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAEA;AACA;AACA;AACA;AAJA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAQA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAEA;AACA;AACA;AAHA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAWA;;;;A","sourceRoot":""}